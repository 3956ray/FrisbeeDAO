# FrisbeDAO 產品需求文檔 (PRD) - 更新版

## 1. 產品概述

### 1.1 產品定位

FrisbeDAO 是一個專為飛盤運動員打造的代幣化社交平臺，結合 X/Instagram 簡約風格與個人代幣經濟模型，讓每位運動員都擁有自己的"股票"。

### 1.2 核心價值主張

- **運動員代幣化**：每位運動員都可發行個人代幣
- **粉絲投資機制**：粉絲可投資支持運動員並獲得特權
- **簡約社交體驗**：類似 X/Instagram 的簡潔界面
- **價值發現平臺**：幫助發現潛力運動員的早期投資機會

### 1.3 目標用戶

- **主要用戶**：飛盤運動員（職業/業餘）
- **次要用戶**：飛盤粉絲/投資者
- **潛在用戶**：其他運動項目運動員

## 2. 功能需求規格

### 2.1 代幣化系統

#### 2.1.1 個人代幣發行

- **功能描述**：運動員可發行 ERC-20 個人代幣
- **發行機制**：聯合曲線自動定價（非AMM模式）
- **初始參數**：
    - 初始價格：$0.01
    - 最大供應量：100,000 代幣
    - 價格計算公式：P = 0.01 * (1 + supply/1000)^1.5
    - 無滑點，即時成交，無需對手方

#### 2.1.2 代幣交易系統

- **購買流程**：連接錢包 → 選擇金額 → 確認交易 → 獲得代幣
- **售出流程**：選擇代幣數量 → 確認交易 → 獲得 ETH
- **收益分配**：
    - 運動員：75%
    - 平臺手續費：20%
    - 流動性池：5%（作為價格穩定準備金）

#### 2.1.3 等級系統

基於**累計投資金額**的四級制度：

- **大眾級**：$0 投資
- **黃金級**：$50+ 累計投資
- **鉑金級**：$200+ 累計投資
- **鑽石級**：$500+ 累計投資

**等級特權**：

- 大眾：基礎互動（點讚、評論）
- 黃金：評論優先顯示、特殊標識
- 鉑金：專屬內容訪問權、優先私信
- 鑽石：專屬內容 + 運動員決策投票權 + 一對一互動機會

#### 2.1.4 自動價格調整機制（混合模式）

**執行架構**：

- **鏈下計算**：每小時執行價格計算
- **鏈上更新**：每24小時通過預言機批量更新
- **數據來源**：Chainlink Automation定時任務

**權重分配**：

- 比賽成績：35%（通過預言機從官網獲取）
- 官方成就：35%（獎項、認證等級提升）
- 粉絲增長：15%（社交媒體粉絲數變化）
- 發布頻率：10%（內容發布活躍度）
- 互動數據：5%（點讚、評論、轉發數量）

**價格調整範圍**：每24小時最大調整±10%

#### 2.1.5 流動性池機制

**5%流動性池運作方式**：

- **價格穩定器功能**：
    - 當賣壓過大時，池子自動承接
    - 當買壓過大時，池子釋放流動性
    - 設置價格波動上下限（±20%/天）
- **資金分配**：
    - 2% 價格穩定準備金
    - 2% 緊急贖回保證金
    - 1% 市場推廣激勵池

### 2.2 社交功能系統

#### 2.2.1 核心社交功能

**動態發布**：

- 支援文字（280字符限制）
- 支援圖片（最多4張，1080p，IPFS存儲）
- 支援視頻（最長60秒，720p，IPFS存儲）
- 支援付費內容（代幣持有者解鎖）

**互動功能**：

- 點讚：無限制
- 評論：支援二級評論，代幣持有者優先顯示
- 轉發：可添加評論轉發
- 私信：端到端加密聊天（參考Farcaster實現）

**關注系統**：

- 關注/取消關注
- 關注者/粉絲列表
- 相互關注好友列表

#### 2.2.2 私信加密機制

**技術實現**：

- 使用 ethereum-cryptography 庫
- 基於錢包地址生成密鑰對
- ECDH生成共享密鑰
- AES-256-GCM加密消息
- 密文存儲在PostgreSQL
- 7天自動刪除機制

**簡化特性**（MVP階段）：

- 暫不實現前向保密
- 暫不支援群聊
- 簡單的已讀回執
- 公鑰存儲在用戶Profile

### 2.3 運動員認證系統

#### 2.3.1 社交媒體認證

**支援平台與要求**：

- **Instagram**：OAuth2.0認證，最低100粉絲
- **Twitter/X**：OAuth2.0認證，最低100粉絲
- **小紅書**：第三方認證服務，最低100粉絲
- **TikTok**：OAuth2.0認證，最低100粉絲

**認證流程**：

1. 用戶授權社交媒體帳號
2. 後端驗證粉絲數量
3. 生成認證憑證
4. 鏈上記錄認證狀態
5. 每30天自動重新驗證

**鏈上存儲結構**：

- 認證狀態布林值
- 認證時間戳
- 平台類型
- 粉絲數量
- 社交ID哈希（加密存儲）

### 2.4 數據管理系統

#### 2.4.1 數據存儲架構（方案C：實用主義）

**鏈上數據（Polygon zkEVM）**：

- 錢包地址映射
- 代幣餘額與交易哈希
- 等級認證狀態
- 內容CID索引
- 關鍵數據哈希

**IPFS存儲（Pinata + CloudFlare CDN）**：

- 用戶頭像與個人資料
- 動態圖片/視頻內容
- 比賽記錄文檔
- 運動員成就證明
- 內容CID存鏈上，原始數據存IPFS

**PostgreSQL（關係型數據）**：

- 用戶基礎信息
- 動態內容索引
- 加密私信（AES-256-GCM）
- 交易記錄緩存
- 數據分析指標

**Redis（緩存層）**：

- 熱門動態緩存（TTL: 1小時）
- 實時排行榜（TTL: 5分鐘）
- Session管理
- WebSocket連接池
- 價格數據緩存

#### 2.4.2 預言機數據獲取

**比賽數據來源**：

- 中華民國飛盤協會官網
- WFDF世界飛盤總會
- 各大賽事官方網站

**數據抓取策略**：

- 定時爬蟲（每6小時）
- API優先（如有提供）
- HTML解析作為備選方案
- 3-5個數據採集節點
- 多數共識驗證機制
- 批量上鏈處理

### 2.5 商業模式

#### 2.5.1 收入來源

1. **代幣交易手續費**：每筆交易收取 20%
2. **高級功能訂閱**：月費 $9.99
3. **廣告收入**：精準投放運動相關廣告
4. **贊助撮合費**：品牌與運動員對接收取 10%

#### 2.5.2 成本結構

- **開發維護**：40%
- **服務器雲端**：20%
- **營銷推廣**：25%
- **法務合規**：10%
- **團隊運營**：5%

## 3. 技術需求規格

### 3.1 區塊鏈架構

- **主鏈**：Polygon zkEVM（低 Gas 費、高 TPS）
- **智能合約**：Solidity + OpenZeppelin + 代理模式
- **錢包整合**：RainbowKit + Wagmi + MetaMask
- **預言機**：Chainlink Automation（定時任務與數據更新）

### 3.2 後端架構

- **API 框架**：Node.js + Express + TypeScript
- **數據庫**：PostgreSQL（關係型）+ Redis（緩存）
- **文件存儲**：IPFS/Pinata（去中心化）+ CloudFlare CDN（加速）
- **消息隊列**：Redis Pub/Sub
- **社交認證**：OAuth2.0整合（Instagram/Twitter/TikTok API）

### 3.3 前端架構

- **框架**：Next.js + TypeScript + Tailwind CSS
- **狀態管理**：Zustand + React Query
- **UI 組件**：Headless UI + Radix UI
- **圖表庫**：TradingView Lightweight Charts
- **加密庫**：ethereum-cryptography（私信加密）

### 3.4 安全需求

- **智能合約審計**：第三方專業審計
- **前端安全**：XSS/CSRF 防護
- **API 安全**：JWT 認證 + Rate Limiting
- **數據加密**：
    - AES-256-GCM（敏感數據）
    - E2E加密（私信）
    - 字段級加密（個人信息）
- **預言機安全**：多節點驗證 + 多簽機制

---

